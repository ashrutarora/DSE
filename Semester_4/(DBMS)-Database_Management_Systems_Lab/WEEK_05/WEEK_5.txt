5.1
SELECT NAME
FROM EMP
WHERE DESIGNATION = (SELECT DESIGNATION FROM EMP WHERE EMPCODE = 100);

5.2
SELECT NAME
FROM EMP
WHERE REPORTS_TO = (SELECT EMPCODE FROM EMP WHERE NAME = 'VIJAY');

5.3
SELECT NAME, DESIGNATION, EMAIL, PRJ_NAME
FROM EMP E NATURAL JOIN WORK_EXP NATURAL JOIN PRJ_DETAILS
WHERE PRJ_NAME IN 
( SELECT PRJ_NAME
FROM PRJ_DETAILS NATURAL JOIN WORK_EXP NATURAL JOIN EMP
WHERE NAME = 'VIJAY');

5.4
SELECT E.NAME
FROM EMP E
INNER JOIN FAMILY_DEPENDENTS F
ON E.EMPCODE = F.EMPNO
WHERE F.RELATIONSHIP = 'DAUGHTER';

5.5
SELECT NAME, PRJ_NAME
FROM EMP NATURAL JOIN WORK_EXP NATURAL JOIN PRJ_DETAILS
WHERE PRJ_NAME NOT IN 'SPYDER';

5.6
SELECT DISTINCT E.NAME
FROM EMP E
INNER JOIN WORK_EXP W ON E.EMPCODE = W.EMPCODE
INNER JOIN EMP_SKILL ES ON ES.EMPNO = W.EMPCODE
WHERE SKILLID = SOME(
SELECT ES.SKILLID
FROM WORK_EXP W
INNER JOIN EMP_SKILL ES ON ES.EMPNO = W.EMPCODE
WHERE W.PRJID = 'P1');

5.7
SELECT NAME
FROM EMP NATURAL JOIN WORK_EXP
WHERE PRJID = 'P1'
AND WORK_EXPERIENCE > SOME(
SELECT WORK_EXPERIENCE
FROM WORK_EXP
WHERE PRJID = 'P2'
);

5.8
SELECT DISTINCT e.NAME
FROM EMP e
JOIN WORK_EXP w ON e.EMPCODE = w.EMPCODE
JOIN PRJ_DETAILS p ON w.PRJID = p.PRJID
WHERE EXISTS (
SELECT 1
FROM WORK_EXP w2
JOIN PRJ_DETAILS p2 ON w2.PRJID = p2.PRJID
WHERE w2.EMPCODE = 100 AND p2.PRJID = p.PRJID AND w2.CLIENTID = w.CLIENTID
);

5.13
SELECT EMP.NAME, COUNT(FAMILY_DEPENDENTS.DEP_NAME) AS NUM_DEPENDENTS
FROM EMP
LEFT JOIN FAMILY_DEPENDENTS
ON EMP.EMPCODE = FAMILY_DEPENDENTS.EMPNO
GROUP BY EMP.NAME;

5.14
SELECT TO_CHAR(POLICYDATE, 'YYYY') AS YEAR, SUM(PREMIUM) AS TOTAL_PREMIUM
FROM MEDICAL_POLICY
GROUP BY TO_CHAR(POLICYDATE, 'YYYY');

5.15
